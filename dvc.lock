schema: '2.0'
stages:
  prepare:
    cmd: python data_loader.py data/all_data data/prepared
    deps:
    - path: data/all_data
      hash: md5
      md5: d9136130f3edf731ea7d5bf558c20bd7.dir
      size: 375986530
      nfiles: 14493
    - path: data_loader.py
      hash: md5
      md5: 3df803cbda8ed12e142fcc26f7ebf8ed
      size: 1945
    params:
      params.yaml:
        data:
          dir: ./data/all_data
        prepare:
          seed: 42
          split: 0.3
          image_size: 224
          sample_fraction: 0.85
          excluded_classes:
          - sky surfing
          - ultimate
          - wingsuit flying
          - arm wrestling
          - horseshoe pitching
          - water cycling
          - wheelchair basketball
          - baton twirling
          - hydroplane racing
          max_images_per_class: 120
        train:
          seed: 42
          lr: 0.0006
          epochs: 2
          batch_size: 2
          num_classes: 2
          num_folds: 2
    outs:
    - path: data/prepared
      hash: md5
      md5: f43e98b9f95cfe5b9816fabb4542527b.dir
      size: 5741625
      nfiles: 204
  train:
    cmd: python train.py data/prepared model_versions
    deps:
    - path: data/prepared
      hash: md5
      md5: f43e98b9f95cfe5b9816fabb4542527b.dir
      size: 5741625
      nfiles: 204
    - path: train.py
      hash: md5
      md5: 024bb75e3ccfacb287b09ac0bd204123
      size: 6782
    params:
      params.yaml:
        model:
          name: google/efficientnet-b0
        train:
          seed: 42
          lr: 0.0006
          epochs: 2
          batch_size: 2
          num_classes: 2
          num_folds: 2
    outs:
    - path: model_versions
      hash: md5
      md5: 3fa26edcf00ee439b7ddeff85619524b.dir
      size: 31249373
      nfiles: 5
  evaluate:
    cmd: python evaluate.py model_versions data/prepared evaluation_outputs
    deps:
    - path: data/prepared
      hash: md5
      md5: f43e98b9f95cfe5b9816fabb4542527b.dir
      size: 5741625
      nfiles: 204
    - path: evaluate.py
      hash: md5
      md5: ddc3c5f32d613da9232c99f612f4260d
      size: 7897
    - path: model_versions
      hash: md5
      md5: 3fa26edcf00ee439b7ddeff85619524b.dir
      size: 31249373
      nfiles: 5
    outs:
    - path: evaluation_outputs/confusion_matrix.png
      hash: md5
      md5: 6e6a079dd605d5c0484800b0f86cd3e1
      size: 24568
    - path: evaluation_outputs/loss_curve.png
      hash: md5
      md5: 1c85186a02fba38c9567e4dee90e814f
      size: 21032
    - path: evaluation_outputs/metrics.json
      hash: md5
      md5: 460e72d6497c9aaf20c3daec3fe17096
      size: 877
    - path: evaluation_outputs/normalized_confusion_matrix.png
      hash: md5
      md5: 9d4bdea5e7b61d41dfb02154d3fadd04
      size: 27979
